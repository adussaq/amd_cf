<html>
	<head>
		<script src="workersPackage.js"></script>
		<script src ="jquery-2.1.4.min.js"></script>
		<script src = "fitCurves.js"></script>
		<script>
			var X = [[1],[2],[3],[4],[5],[6],[7],[8],[9],[10]];
			var y1 = [1.33, 9.15, 28.68, 60.3, 119.59, 224.1, 337.98, 528.93, 708.75, 1021.79];
			var y2 = [4.81, 20.5, 54.56, 137.46, 252.65, 430.23, 679.79, 1053.03, 1446.35, 2009.69];

			var eqStr = "{stringified:'a * x ^ 3 + b',func:function(xVector,P){return P[0]*Math.pow(xVector[0],3)+P[1];},setInitial:function(x_mat,y_vec){var A=(y_vec[1]-y_vec[0])/(Math.pow(x_mat[1][0],3)-Math.pow(x_mat[0][0],3));var B=y_vec[0]-A*Math.pow(x_mat[0][0],3);return [A,B];},description:'For fitting two parameter Ax^3+B cubic function'}";

			var worker = amd_ww.startWorkers({filename:'fitCurvesWorker.js'});

			var data = {
				x_values: X,
				y_values: y1,
				equation: eqStr,
			}
		</script>
	</head>
	<body>
		<h2>Open the console to test curve fitting with web workers!</h2>
		<b>The following is the set up, this has already been done for you!</b><br />
		<pre><code>
/* This has already been defined */
var X = [[1],[2],[3],[4],[5],[6],[7],[8],[9],[10]];
var y1 = [1.33, 9.15, 28.68, 60.3, 119.59, 224.1, 337.98, 528.93, 708.75, 1021.79];
var y2 = [4.81, 20.5, 54.56, 137.46, 252.65, 430.23, 679.79, 1053.03, 1446.35, 2009.69];

<b>The following is the contents of simpleCubic.json</b><br />
<pre><code>
{
	stringified: 'a * x ^ 3 + b',
	func: function (xVector, P) {
		return P[0] * Math.pow(xVector[0],3) + P[1];
	},
	setInitial: function (x_mat, y_vec) {
		// For other data, this must be made more intelligent
		var A = ( y_vec[1] - y_vec[0] ) / (Math.pow(x_mat[1][0], 3) - Math.pow(x_mat[0][0], 3));
		var B = y_vec[0] - A * Math.pow(x_mat[0][0], 3);

        return [A, B];
	},
	description: 'For fitting two parameter Ax^3+B cubic function'
} 
</code></pre>
<b>Copy and paste this into your console to run this functions.</b><br />
<pre><code>
/* This is done asynchronously, start by grabbing your function of interest */

var eq_obj = amd_cf.getEquation('simpleCubic.jsonp');

/* Set up your data */
var data1 = {
	x_values: X,
	y_values: y1,
};

var data2 = {
	x_values: X,
	y_values: y2,
};

//Fits the data asynchronously
eq_obj.fitEquation(data1, function(res, cleanOriginData) {
	//cleanOriginData is the data with all functions removed
	console.log('Done With 1', res);
});

//Fits the data asynchronously
eq_obj.fitEquation(data2, function(res, cleanOriginData) {
	//cleanOriginData is the data with all functions removed
	console.log('Done With 2', res);
});

// If a lot of fits are called, this will be called once all fitting is completed
eq_obj.doneFitting(function() {
	console.log('Done With All!');
});
		</code></pre>
	</body>
</html>
